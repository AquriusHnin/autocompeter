!function(e,t){"use strict";function n(e,n){var a=t.createElement(e);for(var l in n)a[l]=n[l];return a}function a(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent(t,n)}function l(){var e,t,n,a,l,r,o,u=[].slice;for(a=arguments[0],n=2<=arguments.length?u.call(arguments,1):[],r=0,o=n.length;o>r;r++){t=n[r];for(e in t)l=t[e],a[e]=l}return a}function r(r,o,u){function s(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function i(e){var t=L.map(s),n=new RegExp("\\b("+t.join("|")+")","gi");return e.replace(n,"<b>$1</b>")}function c(e){"P"===e.target.tagName&&w!==+e.target.dataset.i&&(w=+e.target.dataset.i,d())}function d(){var e,a;if(null!==T){if(T.length){E.style.display="block";var l=E.getElementsByTagName("p");for(e=l.length-1;e>=0;e--)l[e].remove()}else E.style.display="none";b=[];var o,u,c=null,d=[];T.length||(x.value=r.value);var v=L.map(s),p=new RegExp("\\b("+v.join("|")+")(\\w+)\\b","gi"),f=t.createDocumentFragment();for(e=0,a=T.length;a>e;e++){for(var m,h;null!==(m=p.exec(T[e][1]));)h=new RegExp("\\b"+s(m[0])+"\\b","gi"),c=m[m.length-1],void 0===c||h.test(r.value)||w===e&&d.push(c);o=n("p"),e===w&&o.classList.add("selected"),o.dataset.i=e,u=n("a",{innerHTML:i(T[e][1]),href:T[e][0]}),o.appendChild(u),f.appendChild(o),b.push(o)}E.appendChild(f),d.length&&" "!==r.value.charAt(r.value.length-1)?(c=d[w%d.length],x.value=r.value+c):x.value=r.value}}function v(e){var t=e.parentNode;if("FORM"===t.nodeName)return t;if(null===t)throw"too deep. no parent form node to be found";return v(t)}function p(t){var n,a;if("tab"===t)x.value!==r.value&&(r.value=x.value+" "),r.value!==x.value&&h();else if("down"===t||"up"===t){for("down"===t?w=Math.min(b.length-1,++w):"up"===t&&(w=Math.max(0,--w)),n=0,a=b.length;a>n;n++)n===w?b[n].classList.add("selected"):b[n].classList.remove("selected");d()}else if("enter"===t){if(!b.length)return v(r).submit(),!0;var l=b[w],o=l.getElementsByTagName("a")[0];r.value=x.value=o.textContent,E.style.display="none",e.location=o.href}else"esc"===t&&(E.style.display="none");return!1}function f(e){var t={13:"enter",9:"tab",38:"up",40:"down",27:"esc"};return t[e.keyCode]?(e.preventDefault(),p(t[e.keyCode])):!1}function m(){E.style.display="none"}function h(){if(!r.value.trim())return x.value="",void(E.style.display="none");if(w=0,M[r.value.trim()]){var t=M[r.value.trim()];L=t.terms,T=t.results,d()}else{var n;e.XMLHttpRequest?n=new XMLHttpRequest:e.ActiveXObject&&(n=new ActiveXObject("Microsoft.XMLHTTP")),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var e=JSON.parse(n.responseText);M[r.value.trim()]=e,L=e.terms,T=e.results,d()}else console.warn(n.status,n.responseText),m()},n.open("GET",u.url+encodeURIComponent(r.value.trim()),!0),n.send()}}function g(e){x.value=r.value,setTimeout(function(){E.style.display="none"},200),e.preventDefault()}function y(){r.value.length&&b.length&&(E.style.display="block")}u=u||{},u=l({url:"http://autocompeter.com/v1",domain:o},u||{}),u.domain=u.domain||location.host,u.url+=u.url.indexOf("?")>-1?"&":"?",u.number&&(u.url+="n="+u.number+"&"),u.url+="d="+u.domain+"&q=";var b=[],w=0;r.spellcheck=!1,r.autocomplete="off";var N=n("span",{className:"_ac-wrap"}),x=n("input",{tabindex:-1,spellcheck:!1,autocomplete:"off",readonly:"readonly",type:"text",className:r.className+" _ac-hint"});r.classList.add("_ac-foreground"),N.appendChild(x);var C=r.cloneNode(!0);N.appendChild(C);var E=n("div",{className:"_ac-results"});a(E,"mouseover",c),N.appendChild(E),r.parentElement.insertBefore(N,r),r.parentNode.removeChild(r),r=C;var L,T=null,M={};a(r,"input",h),a(r,"keydown",f),a(r,"blur",g),a(r,"focus",y),r.value.length&&h()}e.Autocompeter=r}(window,document);